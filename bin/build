#!/usr/bin/env bash

SCRIPT_DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"

# Code path
if hash realpath 2>/dev/null; then
    # Fedora
    echo "Using realpath ..."
    export CODEBASE=$(realpath $SCRIPT_DIR/..)
elif hash grealpath 2>/dev/null; then
    # Mac, with: `brew install coreutils; brew link coreutils`
    echo "Using grealpath ..."
    export CODEBASE=$(grealpath $SCRIPT_DIR/..)
else
    echo "Using readlink ..."
    export CODEBASE=$(readlink -e $SCRIPT_DIR/..)
fi

if [ -z "$CODEBASE" ]; then
    echo "Unable to determine absolute codebase directory"
    exit 1
fi

cd "$CODEBASE"

bin/gulp build
rc=$?; if [ $rc != 0 ]; then exit $rc; fi
